<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 1800">
  <!-- Titre principal -->
  <text x="700" y="40" font-size="24" font-weight="bold" text-anchor="middle" fill="#333">
    TD INF250 - Diagrammes d'architecture réseau
  </text>
  
  <!-- ========== SCHÉMA 1: ARCHITECTURE VULNÉRABLE (AS-IS) ========== -->
  <text x="700" y="80" font-size="18" font-weight="bold" text-anchor="middle" fill="#c00">
    SCHÉMA 1 : Architecture VULNÉRABLE (AS-IS) - À ANNOTER
  </text>
  
  <!-- Internet -->
  <ellipse cx="700" cy="140" rx="80" ry="30" fill="#ff6b6b" stroke="#c00" stroke-width="2"/>
  <text x="700" y="148" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">INTERNET</text>
  <text x="700" y="162" font-size="10" text-anchor="middle" fill="#fff">0.0.0.0/0</text>
  
  <!-- Flèche vers bas -->
  <line x1="700" y1="170" x2="700" y2="210" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="720" y="195" font-size="11" fill="#c00" font-weight="bold">⚠️ Pas de firewall</text>
  
  <!-- Zone publique - pas de segmentation -->
  <rect x="250" y="220" width="900" height="420" fill="none" stroke="#ff9999" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="260" y="240" font-size="12" fill="#c00" font-weight="bold">⚠️ Pas de VNet - Tous les services exposés publiquement</text>
  
  <!-- IP Publique -->
  <rect x="630" y="250" width="140" height="40" fill="#ffd700" stroke="#f90" stroke-width="2"/>
  <text x="700" y="268" font-size="12" font-weight="bold" text-anchor="middle">IP Publique</text>
  <text x="700" y="282" font-size="10" text-anchor="middle">20.123.45.67</text>
  
  <!-- Flèche -->
  <line x1="700" y1="290" x2="700" y2="330" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Frontend -->
  <rect x="600" y="340" width="200" height="80" fill="#87ceeb" stroke="#333" stroke-width="2"/>
  <text x="700" y="365" font-size="14" font-weight="bold" text-anchor="middle">Frontend (React)</text>
  <text x="700" y="382" font-size="11" text-anchor="middle">App Service</text>
  <text x="700" y="396" font-size="10" text-anchor="middle">Port: 80, 443</text>
  <text x="700" y="410" font-size="9" fill="#c00" text-anchor="middle">⚠️ Accès public direct</text>
  
  <!-- Zone d'annotation -->
  <rect x="820" y="340" width="300" height="80" fill="#fff9e6" stroke="#f90" stroke-width="1"/>
  <text x="830" y="360" font-size="11" font-weight="bold" fill="#c00">ANNOTATIONS (à compléter):</text>
  <text x="830" y="378" font-size="10" fill="#666">1. _______________________</text>
  <text x="830" y="394" font-size="10" fill="#666">2. _______________________</text>
  <text x="830" y="410" font-size="10" fill="#666">3. _______________________</text>
  
  <!-- Flèche -->
  <line x1="700" y1="420" x2="700" y2="460" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="720" y="445" font-size="10" fill="#666">HTTP (non chiffré)</text>
  
  <!-- Backend -->
  <rect x="600" y="470" width="200" height="80" fill="#98fb98" stroke="#333" stroke-width="2"/>
  <text x="700" y="495" font-size="14" font-weight="bold" text-anchor="middle">Backend API (Express)</text>
  <text x="700" y="512" font-size="11" text-anchor="middle">App Service</text>
  <text x="700" y="526" font-size="10" text-anchor="middle">Port: 3001</text>
  <text x="700" y="540" font-size="9" fill="#c00" text-anchor="middle">⚠️ Secrets en clair</text>
  
  <!-- Zone d'annotation -->
  <rect x="820" y="470" width="300" height="80" fill="#fff9e6" stroke="#f90" stroke-width="1"/>
  <text x="830" y="490" font-size="11" font-weight="bold" fill="#c00">ANNOTATIONS (à compléter):</text>
  <text x="830" y="508" font-size="10" fill="#666">1. _______________________</text>
  <text x="830" y="524" font-size="10" fill="#666">2. _______________________</text>
  <text x="830" y="540" font-size="10" fill="#666">3. _______________________</text>
  
  <!-- Flèche -->
  <line x1="700" y1="550" x2="700" y2="590" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="720" y="575" font-size="10" fill="#c00" font-weight="bold">⚠️ SSL Disabled</text>
  
  <!-- Database -->
  <rect x="600" y="600" width="200" height="80" fill="#ffb6c1" stroke="#333" stroke-width="2"/>
  <text x="700" y="625" font-size="14" font-weight="bold" text-anchor="middle">MySQL Database</text>
  <text x="700" y="642" font-size="11" text-anchor="middle">Flexible Server</text>
  <text x="700" y="656" font-size="10" text-anchor="middle">Port: 3306</text>
  <text x="700" y="670" font-size="9" fill="#c00" text-anchor="middle">⚠️ Firewall: 0.0.0.0/0</text>
  
  <!-- Zone d'annotation -->
  <rect x="820" y="600" width="300" height="80" fill="#fff9e6" stroke="#f90" stroke-width="1"/>
  <text x="830" y="620" font-size="11" font-weight="bold" fill="#c00">ANNOTATIONS (à compléter):</text>
  <text x="830" y="638" font-size="10" fill="#666">1. _______________________</text>
  <text x="830" y="654" font-size="10" fill="#666">2. _______________________</text>
  <text x="830" y="670" font-size="10" fill="#666">3. _______________________</text>
  
  <!-- Accès direct depuis Internet vers DB -->
  <line x1="280" y1="140" x2="280" y2="640" stroke="#c00" stroke-width="3" stroke-dasharray="8,4"/>
  <line x1="280" y1="640" x2="600" y2="640" stroke="#c00" stroke-width="3" stroke-dasharray="8,4" marker-end="url(#arrowhead-red)"/>
  <text x="160" y="400" font-size="11" fill="#c00" font-weight="bold" transform="rotate(-90 160 400)">
    ⚠️ ACCÈS DIRECT INTERNET → DATABASE
  </text>
  
  <!-- Légende vulnérabilités -->
  <rect x="280" y="700" width="840" height="120" fill="#ffe6e6" stroke="#c00" stroke-width="2"/>
  <text x="700" y="725" font-size="14" font-weight="bold" text-anchor="middle" fill="#c00">
    VULNÉRABILITÉS IDENTIFIÉES (à compléter avec V01, V02, V03...)
  </text>
  <text x="300" y="750" font-size="11" fill="#666">V01: ___________________________________________</text>
  <text x="300" y="770" font-size="11" fill="#666">V02: ___________________________________________</text>
  <text x="300" y="790" font-size="11" fill="#666">V03: ___________________________________________</text>
  <text x="750" y="750" font-size="11" fill="#666">V04: ___________________________________________</text>
  <text x="750" y="770" font-size="11" fill="#666">V05: ___________________________________________</text>
  <text x="750" y="790" font-size="11" fill="#666">V06: ___________________________________________</text>
  
  
  <!-- ========== SCHÉMA 2: ARCHITECTURE SÉCURISÉE (TO-BE) ========== -->
  <text x="700" y="880" font-size="18" font-weight="bold" text-anchor="middle" fill="#0a0">
    SCHÉMA 2 : Architecture SÉCURISÉE (TO-BE) - À CONCEVOIR
  </text>
  
  <!-- Internet -->
  <ellipse cx="700" cy="940" rx="80" ry="30" fill="#ff6b6b" stroke="#c00" stroke-width="2"/>
  <text x="700" y="948" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">INTERNET</text>
  
  <!-- Flèche -->
  <line x1="700" y1="970" x2="700" y2="1010" stroke="#0a0" stroke-width="3" marker-end="url(#arrowhead-green)"/>
  <text x="720" y="995" font-size="11" fill="#0a0" font-weight="bold">✓ HTTPS uniquement</text>
  
  <!-- Application Gateway + WAF -->
  <rect x="580" y="1020" width="240" height="60" fill="#4169e1" stroke="#00008b" stroke-width="3"/>
  <text x="700" y="1045" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">Application Gateway</text>
  <text x="700" y="1062" font-size="11" text-anchor="middle" fill="#fff">+ WAF (Web Application Firewall)</text>
  
  <!-- VNet -->
  <rect x="200" y="1100" width="1000" height="600" fill="#e6f3ff" stroke="#0066cc" stroke-width="3"/>
  <text x="220" y="1130" font-size="14" font-weight="bold" fill="#0066cc">
    VNet Production (10.0.0.0/16)
  </text>
  
  <!-- Subnet Public -->
  <rect x="230" y="1150" width="280" height="180" fill="#b3d9ff" stroke="#0066cc" stroke-width="2"/>
  <text x="240" y="1175" font-size="12" font-weight="bold" fill="#0066cc">Subnet Public (10.0.1.0/24)</text>
  <text x="240" y="1195" font-size="11" fill="#0a0">✓ NSG configuré</text>
  
  <rect x="260" y="1210" width="220" height="60" fill="#87ceeb" stroke="#333" stroke-width="2"/>
  <text x="370" y="1235" font-size="13" font-weight="bold" text-anchor="middle">Frontend</text>
  <text x="370" y="1252" font-size="10" text-anchor="middle">Private Endpoint</text>
  
  <!-- Subnet App -->
  <rect x="540" y="1150" width="280" height="180" fill="#b3d9ff" stroke="#0066cc" stroke-width="2"/>
  <text x="550" y="1175" font-size="12" font-weight="bold" fill="#0066cc">Subnet App (10.0.2.0/24)</text>
  <text x="550" y="1195" font-size="11" fill="#0a0">✓ NSG configuré</text>
  
  <rect x="570" y="1210" width="220" height="60" fill="#98fb98" stroke="#333" stroke-width="2"/>
  <text x="680" y="1235" font-size="13" font-weight="bold" text-anchor="middle">Backend API</text>
  <text x="680" y="1252" font-size="10" text-anchor="middle">Private Endpoint</text>
  
  <!-- Subnet Data -->
  <rect x="850" y="1150" width="280" height="180" fill="#b3d9ff" stroke="#0066cc" stroke-width="2"/>
  <text x="860" y="1175" font-size="12" font-weight="bold" fill="#0066cc">Subnet Data (10.0.3.0/24)</text>
  <text x="860" y="1195" font-size="11" fill="#0a0">✓ NSG configuré</text>
  
  <rect x="880" y="1210" width="220" height="60" fill="#ffb6c1" stroke="#333" stroke-width="2"/>
  <text x="990" y="1235" font-size="13" font-weight="bold" text-anchor="middle">MySQL Database</text>
  <text x="990" y="1252" font-size="10" text-anchor="middle">Private Endpoint</text>
  
  <!-- Subnet Bastion -->
  <rect x="230" y="1360" width="280" height="120" fill="#ffd700" stroke="#f90" stroke-width="2"/>
  <text x="240" y="1385" font-size="12" font-weight="bold" fill="#f90">Subnet Bastion (10.0.10.0/27)</text>
  
  <rect x="260" y="1400" width="220" height="50" fill="#ffa500" stroke="#333" stroke-width="2"/>
  <text x="370" y="1425" font-size="13" font-weight="bold" text-anchor="middle">Azure Bastion</text>
  <text x="370" y="1440" font-size="10" text-anchor="middle">Administration sécurisée</text>
  
  <!-- Flux réseau à dessiner -->
  <line x1="700" y1="1080" x2="370" y2="1150" stroke="#0a0" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="370" y1="1270" x2="680" y2="1210" stroke="#0a0" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="680" y1="1270" x2="990" y2="1210" stroke="#0a0" stroke-width="2" stroke-dasharray="5,5"/>
  
  <!-- Key Vault (en dehors du VNet mais accessible) -->
  <rect x="230" y="1510" width="280" height="80" fill="#9370db" stroke="#4b0082" stroke-width="2"/>
  <text x="370" y="1540" font-size="13" font-weight="bold" text-anchor="middle" fill="#fff">Azure Key Vault</text>
  <text x="370" y="1560" font-size="10" text-anchor="middle" fill="#fff">Gestion des secrets</text>
  <text x="370" y="1575" font-size="10" text-anchor="middle" fill="#fff">+ Managed Identity</text>
  
  <!-- Log Analytics -->
  <rect x="540" y="1510" width="280" height="80" fill="#20b2aa" stroke="#008b8b" stroke-width="2"/>
  <text x="680" y="1540" font-size="13" font-weight="bold" text-anchor="middle" fill="#fff">Log Analytics</text>
  <text x="680" y="1560" font-size="10" text-anchor="middle" fill="#fff">Centralisation logs</text>
  <text x="680" y="1575" font-size="10" text-anchor="middle" fill="#fff">+ Alertes sécurité</text>
  
  <!-- Defender for Cloud -->
  <rect x="850" y="1510" width="280" height="80" fill="#dc143c" stroke="#8b0000" stroke-width="2"/>
  <text x="990" y="1540" font-size="13" font-weight="bold" text-anchor="middle" fill="#fff">Defender for Cloud</text>
  <text x="990" y="1560" font-size="10" text-anchor="middle" fill="#fff">Protection avancée</text>
  <text x="990" y="1575" font-size="10" text-anchor="middle" fill="#fff">+ Threat Intelligence</text>
  
  <!-- Zone à compléter -->
  <rect x="230" y="1620" width="900" height="60" fill="#f0fff0" stroke="#0a0" stroke-width="2"/>
  <text x="680" y="1645" font-size="12" font-weight="bold" fill="#0a0" text-anchor="middle">
    COMPOSANTS DE SÉCURITÉ À AJOUTER (à compléter):
  </text>
  <text x="250" y="1665" font-size="10" fill="#666">1. ____________  2. ____________  3. ____________  4. ____________</text>
  
  <!-- Définitions des marqueurs de flèches -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#666"/>
    </marker>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#c00"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#0a0"/>
    </marker>
  </defs>
  
  <!-- Instructions -->
  <rect x="50" y="1730" width="1300" height="60" fill="#fffacd" stroke="#daa520" stroke-width="2"/>
  <text x="700" y="1755" font-size="13" font-weight="bold" text-anchor="middle">
    INSTRUCTIONS: Annotez le schéma 1 avec les vulnérabilités identifiées. Complétez le schéma 2 avec votre architecture sécurisée.
  </text>
  <text x="700" y="1775" font-size="11" text-anchor="middle">
    Ajoutez les règles NSG, les flux réseau, et les composants de sécurité manquants dans les zones prévues.
  </text>
</svg>